<div class="project-list">
  <div class="project-list-header">
    <h1>
      Projekte

      <button
        *ngIf="hasProjectCreationPermission()"
        (click)="openProjectEditorDialog(null)"
        mat-icon-button
        matTooltip="Neues Projekt hinzufügen"
        class="no-hover"
      >
        <mat-icon> add </mat-icon>
      </button>
    </h1>

    <mat-form-field class="status-search">
      <mat-select
        [formControl]="selectedStatusOption"
        (selectionChange)="filterProjects()"
        placeholder="Status"
      >
        <mat-option>Alle</mat-option>

        <mat-option
          *ngFor="let statusOption of statusOptions | keyvalue"
          [value]="statusOption.value"
        >
          {{ statusOption.value | titlecase }}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-label *ngIf="isLoadingStudyPrograms">
        <div class="select-placeholder-container">
          <span>Lädt Studiengänge...</span>
          <mat-spinner class="spinner" diameter="20"></mat-spinner>
        </div>
      </mat-label>
      <mat-select
        placeholder="Studiengänge"
        [formControl]="selectedStudyPrograms"
        multiple
        (selectionChange)="filterModuleTypesByStudyProgram($event)"
      >
        <mat-option
          *ngFor="let studyProgram of suitableStudyPrograms"
          [value]="studyProgram"
          >{{ studyProgram.name }}</mat-option
        >
      </mat-select>
    </mat-form-field>

    <mat-form-field>
      <mat-label *ngIf="isLoadingModuleTypes">
        <div class="select-placeholder-container">
          <span>Lädt Module...</span>
          <mat-spinner class="spinner" diameter="20"></mat-spinner>
        </div>
      </mat-label>
      <mat-select
        placeholder="Module"
        [formControl]="selectedModuleTypes"
        multiple
        (selectionChange)="filterProjects()"
      >
        <mat-option
          *ngFor="let moduleType of suitableModuleTypes"
          [value]="moduleType"
          >{{ moduleType.name }}</mat-option
        >
      </mat-select>
    </mat-form-field>

    <mat-form-field class="search">
      <label>
        <input
          [formControl]="searchString"
          (change)="filterProjects()"
          placeholder="Suche"
          matInput
        />
      </label>
    </mat-form-field>

    <mat-divider></mat-divider>
  </div>

  <app-project-item
    *ngFor="let project of projectsPage"
    (editButtonClicked)="openProjectEditorDialog(project)"
    (deleteButtonClicked)="deleteProject(project)"
    [showEditButton]="hasProjectPermission(project)"
    [showDeleteButton]="hasProjectPermission(project)"
    [project]="project"
  ></app-project-item>

  <mat-paginator
    (page)="changePageIndexOrSize($event)"
    [length]="totalFilteredProjects"
    [pageSize]="pageSize"
    [pageIndex]="pageIndex"
    [pageSizeOptions]="[10, 25, 50]"
  ></mat-paginator>
</div>
