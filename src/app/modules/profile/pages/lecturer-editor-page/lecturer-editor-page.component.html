<app-content-page>
  <app-content-page-header>
    <app-content-page-title>Profil bearbeiten </app-content-page-title>
  </app-content-page-header>
  <app-content-page-content>
    <div class="flex flex-col justify-around items-center">
      <mat-card class="card">
        <mat-card-content>
          <form [formGroup]="profileForm">
            <h3>Persönliche Daten</h3>
            <div class="grid grid-cols-4 gap-4">
              <div class="flex flex-col gap-4 col-span-1">
                <div class="aspect-w-1 aspect-h-1">
                  <img
                    class="object-scale-down"
                    alt="Profile Image"
                    [src]="imageSrc"
                    onerror="this.src='/assets/images/blank-profile-picture.png'"
                  />
                </div>
                <div class="flex flex-row gap-2">
                  <button mat-raised-button color="warn" (click)="deleteProfileImage()"><mat-icon>close</mat-icon> Entfernen</button>
                  <button mat-raised-button (click)="fileInput.click()">
                    <mat-icon>publish</mat-icon> Hochladen
                    <input
                      #fileInput
                      style="display: none"
                      type="file"
                      id="file"
                      accept="image/jpeg, image/png, image/gif"
                      (change)="change($event)"
                    />
                  </button>
                </div>
              </div>
              <div class="col-span-3 flex flex-col gap-4">
                <mat-form-field appearance="fill">
                  <mat-label>Name</mat-label>
                  <input matInput formControlName="name" maxlength="255" required />
                </mat-form-field>
                <mat-form-field apperance="fill" *ngIf="faculties">
                  <mat-label>Fakultät</mat-label>
                  <mat-select [(value)]="selectedFaculty" [compareWith]="compareFaculties" [formControl]="facultySelection">
                    <mat-option *ngFor="let faculty of faculties" [value]="faculty"
                      >[{{ faculty.abbreviation }}] {{ faculty.name }}</mat-option
                    >
                  </mat-select>
                </mat-form-field>
                <mat-form-field appearance="fill">
                  <mat-label>Hochschulzugehörigkeit seit:</mat-label>
                  <input matInput formControlName="affiliation" maxlength="255" />
                </mat-form-field>
                <mat-form-field appearance="fill">
                  <mat-label>Personalseite</mat-label>
                  <input matInput formControlName="collegePage" maxlength="255" />
                </mat-form-field>
              </div>
              <div class="col-span-4">
                <div class="grid grid-cols-2 gap-4">
                  <mat-form-field appearance="fill">
                    <mat-label>Lehrgebiet</mat-label>
                    <input matInput formControlName="subject" maxlength="255" />
                  </mat-form-field>
                  <mat-form-field appearance="fill">
                    <mat-label>Standort, Raum</mat-label>
                    <input matInput formControlName="room" maxlength="255" />
                  </mat-form-field>
                  <mat-form-field appearance="fill">
                    <mat-label>Sprechstunde</mat-label>
                    <input matInput formControlName="consultationHour" maxlength="255" />
                  </mat-form-field>
                  <mat-form-field appearance="fill">
                    <mat-label>Telefonnummer</mat-label>
                    <input matInput formControlName="telephone" maxlength="255" />
                  </mat-form-field>
                  <mat-form-field appearance="fill">
                    <mat-label>E-Mail</mat-label>
                    <input matInput formControlName="email" maxlength="255" />
                  </mat-form-field>
                  <mat-form-field appearance="fill">
                    <mat-label>Homepage</mat-label>
                    <input matInput formControlName="homepage" maxlength="255" />
                  </mat-form-field>
                </div>
              </div>
            </div>
            <br />
            <mat-divider></mat-divider>
            <br />
            <div class="flex flex-col">
              <h3>Forschungsgebiete</h3>
              <mat-form-field class="researchSubjects-chip-list">
                <mat-chip-list #subjectChipList>
                  <mat-chip *ngFor="let subject of researchSubjects" [removable]="true" (removed)="removeSubject(subject)">
                    {{ subject }}
                    <mat-icon matChipRemove>cancel</mat-icon>
                  </mat-chip>

                  <input
                    #researchSubjectInput
                    placeholder="Forschungsgebiete"
                    [matChipInputFor]="subjectChipList"
                    [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                    [matChipInputAddOnBlur]="true"
                    (matChipInputTokenEnd)="addSubject($event)"
                    maxlength="255"
                  />
                </mat-chip-list>
              </mat-form-field>
            </div>
            <br />
            <mat-divider></mat-divider>
            <br />
            <div class="flex flex-col">
              <h3>Werdegang</h3>
              <mat-form-field appearance="fill">
                <textarea matInput cdkTextareaAutosize cdkAutosizeMinRows="5" cdkAutosizeMaxRows="20" formControlName="vita"></textarea>
              </mat-form-field>
            </div>
            <br />
            <mat-divider></mat-divider>
            <br />
            <div class="flex flex-col">
              <h3>Publikationen</h3>
              <p>
                Sie können hier ihre Publikationen in Textform einpflegen. Idealerweise sollten die Publikationen für eine vernünftige
                Formatierung mit mindestens einer Leerzeile getrennt sein.
              </p>
              <mat-form-field appearance="fill">
                <textarea
                  matInput
                  cdkTextareaAutosize
                  cdkAutosizeMinRows="5"
                  formControlName="publications"
                  placeholder="Publikation 1 &#10;&#10;&#10;Publikation 2"
                ></textarea>
              </mat-form-field>
            </div>
            <br />
            <mat-divider></mat-divider>
            <br />
            <div>
              <button mat-raised-button color="primary" (click)="onSubmit()" type="submit" [disabled]="this.profileForm.invalid">
                <mat-icon>save</mat-icon> Speichern
              </button>
            </div>
          </form>
        </mat-card-content>
      </mat-card>
      <br />
    </div>
  </app-content-page-content>
</app-content-page>
