<div>
  <div
    fxLayout="column"
    fxLayoutAlign="space-around center"
    *ngIf="hasPermission"
  >
    <mat-card class="card">
      <mat-card-title>Profil bearbeiten</mat-card-title>
      <mat-card-content>
        <form [formGroup]="profileForm">
          <h3>Persönliche Daten</h3>
          <div
            gdAreas="picture mainInfo | info info"
            gdRows="auto auto"
            gdColumns="25% 73%"
            gdGap="2%"
            gdAreas.lt-md="picture | mainInfo | info"
            gdColumns.lt-md="auto"
            gdRows.lt-md="auto auto auto"
          >
            <div gdArea="picture">
              <div class="profileImageContainer">
                <img
                  class="profileImage"
                  alt="Profile Image"
                  [src]="imageSrc"
                />
              </div>

              <button mat-raised-button (click)="deleteProfileImage()">
                <mat-icon>close</mat-icon> Profilbild entfernen
              </button>
              <button mat-raised-button (click)="fileInput.click()">
                <mat-icon>publish</mat-icon> Profilbild hochladen
                <input
                  #fileInput
                  style="display: none"
                  type="file"
                  id="file"
                  accept="image/jpeg, image/png, image/gif"
                  (change)="uploadImage($event.target.files)"
                />
              </button>
            </div>
            <div gdArea="mainInfo">
              <mat-form-field appearance="fill">
                <mat-label>Name</mat-label>
                <input
                  matInput
                  formControlName="name"
                  maxlength="255"
                  required
                />
              </mat-form-field>
              <br />
              <mat-form-field apperance="fill" *ngIf="faculties">
                <mat-label>Fakultät</mat-label>
                <mat-select
                  [(value)]="selectedFaculty"
                  [compareWith]="compareFaculties"
                  [formControl]="facultySelection"
                >
                  <mat-option
                    *ngFor="let faculty of faculties"
                    [value]="faculty"
                    >[{{ faculty.abbreviation }}] {{ faculty.name }}</mat-option
                  >
                </mat-select>
              </mat-form-field>
              <br />
              <mat-form-field appearance="fill">
                <mat-label>Hochschulzugehörigkeit seit:</mat-label>
                <input matInput formControlName="affiliation" maxlength="255" />
              </mat-form-field>
              <br />
              <mat-form-field appearance="fill">
                <mat-label>Personalseite</mat-label>
                <input matInput formControlName="collegePage" maxlength="255" />
              </mat-form-field>
            </div>
            <div
              gdArea="info"
              fxLayout="row wrap"
              fxLayoutAlign="center center"
              fxLayoutGap="1%"
            >
              <mat-form-field appearance="fill" fxFlex="49" fxFlex.lt-md="100">
                <mat-label>Lehrgebiet</mat-label>
                <input matInput formControlName="subject" maxlength="255" />
              </mat-form-field>
              <mat-form-field appearance="fill" fxFlex="49" fxFlex.lt-md="100">
                <mat-label>Standort, Raum</mat-label>
                <input matInput formControlName="room" maxlength="255" />
              </mat-form-field>
              <mat-form-field appearance="fill" fxFlex="49" fxFlex.lt-md="100">
                <mat-label>Sprechstunde</mat-label>
                <input
                  matInput
                  formControlName="consultationHour"
                  maxlength="255"
                />
              </mat-form-field>
              <mat-form-field appearance="fill" fxFlex="49" fxFlex.lt-md="100">
                <mat-label>Telefonnummer</mat-label>
                <input matInput formControlName="telephone" maxlength="255" />
              </mat-form-field>
              <mat-form-field appearance="fill" fxFlex="49" fxFlex.lt-md="100">
                <mat-label>E-Mail</mat-label>
                <input matInput formControlName="email" maxlength="255" />
              </mat-form-field>
              <mat-form-field appearance="fill" fxFlex="49" fxFlex.lt-md="100">
                <mat-label>Homepage</mat-label>
                <input matInput formControlName="homepage" maxlength="255" />
              </mat-form-field>
            </div>
          </div>
          <br />
          <mat-divider></mat-divider>
          <br />
          <div>
            <h3>Forschungsgebiete</h3>
            <mat-form-field class="researchSubjects-chip-list">
              <mat-chip-list #subjectChipList>
                <mat-chip
                  *ngFor="let subject of researchSubjects"
                  [removable]="true"
                  (removed)="removeSubject(subject)"
                >
                  {{ subject }}
                  <mat-icon matChipRemove>cancel</mat-icon>
                </mat-chip>

                <input
                  #researchSubjectInput
                  placeholder="Forschungsgebiete"
                  [matChipInputFor]="subjectChipList"
                  [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                  [matChipInputAddOnBlur]="true"
                  (matChipInputTokenEnd)="addSubject($event)"
                  maxlength="255"
                />
              </mat-chip-list>
            </mat-form-field>
          </div>
          <br />
          <mat-divider></mat-divider>
          <br />
          <div>
            <h3>Werdegang</h3>
            <mat-form-field appearance="fill">
              <textarea
                matInput
                cdkTextareaAutosize
                cdkAutosizeMinRows="5"
                cdkAutosizeMaxRows="20"
                formControlName="vita"
              ></textarea>
            </mat-form-field>
          </div>
          <br />
          <mat-divider></mat-divider>
          <br />
          <div>
            <h3>Publikationen</h3>
            <p>
              Sie können hier ihre Publikationen in Textform einpflegen.
              Idealerweise sollten die Publikationen für eine vernünftige
              Formatierung mit mindestens einer Leerzeile getrennt sein.
            </p>
            <mat-form-field appearance="fill">
              <textarea
                matInput
                cdkTextareaAutosize
                cdkAutosizeMinRows="5"
                formControlName="publications"
                placeholder="Publikation 1 &#10;&#10;&#10;Publikation 2"
              ></textarea>
            </mat-form-field>
          </div>
          <br />
          <mat-divider></mat-divider>
          <br />
          <div class="buttonContainer">
            <button
              class="saveButton"
              mat-raised-button
              color="primary"
              (click)="onSubmit()"
              type="submit"
              [disabled]="this.profileForm.invalid"
            >
              <mat-icon>save</mat-icon> Speichern
            </button>
          </div>
        </form>
      </mat-card-content>
    </mat-card>
    <br />
  </div>
  <div
    fxLayout="column"
    fxLayoutAlign="space-around center"
    *ngIf="!hasPermission"
  >
    Sie haben keine Berechtigung für diese Seite.
  </div>
</div>
